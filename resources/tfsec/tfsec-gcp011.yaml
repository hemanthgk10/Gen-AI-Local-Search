---
category: IAM
checkTool: tfsec
checkType: Terraform
compliance: []
description: "Permissions should not be directly granted to users, you identify roles that contain the appropriate permissions, and then grant those roles to the user. Granting permissions to users quickly become unwieldy and complex to make large scale changes to remove access to a particular resource. Permissions should be granted on roles, groups, services accounts instead."
extra:
  srcUrl: "https://github.com/tfsec/tfsec/blob/4e68e1c5b3bc66982e4b7e6c5cc1c1642c87f83d/internal/app/tfsec/checks/gcp011.go"
guidelines: |-
    #### Description
    Permissions should not be directly granted to users, you identify roles that contain the appropriate permissions, and then grant those roles to the user.

    #### Rationale
    Granting permissions to users quickly become unwieldy and complex to make large scale changes to remove access to a particular resource.
    Permissions should be granted on roles, groups, services accounts instead.

    #### Remediation
    Do not use individual user account, instead use service accounts.

    Terraform example
    ```
    resource "google_project_iam_binding" "project" {
        project = "your-project-id"
        role    = "roles/editor"
        members = [
    -    		"user:test@example.com",
    +       "group:test@example.com",
        ]
        ...
        ...
    }

    resource "google_storage_bucket_iam_member" "bucket-member" {
         project = "your-project-id"
         role    = "roles/firebase.admin"
    -    member  = "user:test@example.com"
    +    member  = "serviceAccount:test@example.com"
         ...
         ...
    }
    ```

    #### References
    * https://www.terraform.io/docs/providers/google/d/iam_policy.html#members
    * https://cloud.google.com/resource-manager/reference/rest/v1/projects/setIamPolicy
    * https://cloud.google.com/iam/docs/overview#permissions
    * https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_binding
    * https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_member
lwid: []
provider: GCP
ruleId: GCP011
severity: Medium
sid: tfsec-gcp011
title: "IAM granted directly to user"
