---
autofix: true
category: TLS
checkTool: tfsec
checkType: Terraform
compliance: []
description: "Plain HTTP is unencrypted and human-readable. This means that if a malicious actor was to eavesdrop on your connection, they would be able to see all of your data flowing back and forth. You should use HTTPS, which is HTTP over an encrypted (TLS) connection, meaning eavesdroppers cannot read your traffic."
extra:
  srcUrl: "https://github.com/tfsec/tfsec/blob/4e68e1c5b3bc66982e4b7e6c5cc1c1642c87f83d/internal/app/tfsec/checks/aws004.go"
guidelines: |-
    #### Description
    Ensure that Amazon ALBs are using HTTPS protocols.

    #### Rationale
    Amazon ALBs should implement HTTPS to prevent cleartext traffic transmission.

    #### Remediation
    Manual Steps:
      1. Sign in to the AWS Management Console.
      2. Navigate to [EC2 dashboard][ec2-console].
      3. In the left navigation panel, under LOAD BALANCING section, choose Load Balancers.
      4. Select the Listeners tab from the bottom panel to access the load balancer listeners configuration.
      5. Change the listener to https protocol instead of http.

    Terraform example:
    ```
    resource "aws_lb_listener" "front_end" {
       load_balancer_arn = aws_lb.front_end.arn
    -  protocol          = "http"
    -  port              = "8080"
    +  port              = "443"
    +  protocol          = "HTTPS"
       ssl_policy        = "ELBSecurityPolicy-2016-08"
       certificate_arn   = "arn:aws:iam::187416307283:server-certificate/test_cert_adsfas"

       default_action {
         type             = "forward"
         target_group_arn = aws_lb_target_group.front_end.arn
       }
       ...
       ...
    }
    ```

    #### References
    * https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener

    [ec2-console]: https://console.aws.amazon.com/ec2/
lwid: []
provider: AWS
remediation:
  -
    checkType: Terraform
    steps:
      -
        action: modify
        resource:
          - resource
        resourceAttribute: protocol
        resourceAttributeType: string
        resourceAttributeValue: HTTPS
        resourceType:
          - aws_lb_listener
          - aws_alb_listener
      -
        action: modify
        resource:
          - resource
        resourceAttribute: port
        resourceAttributeType: string
        resourceAttributeValue: "443"
        resourceType:
          - aws_lb_listener
          - aws_alb_listener
      -
        action: add
        resource:
          - resource
        resourceAttribute: ssl_policy
        resourceAttributeType: string
        resourceAttributeValue: ELBSecurityPolicy-2016-08
        resourceType:
          - aws_lb_listener
          - aws_alb_listener
      -
        action: add
        resource:
          - resource
        resourceAttribute: certificate_arn
        resourceAttributeType: string
        resourceAttributeValue: "<Provide the ARN of the default SSL server certificate>"
        resourceType:
          - aws_lb_listener
          - aws_alb_listener
ruleId: AWS004
severity: Critical
sid: tfsec-aws004
title: "Use of plain HTTP"
