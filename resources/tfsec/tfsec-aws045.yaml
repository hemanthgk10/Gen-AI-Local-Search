---
autofix: true
category: Security
checkTool: tfsec
checkType: Terraform
compliance: []
description: "You should configure a Web Application Firewall in front of your CloudFront distribution. This will mitigate many types of attacks on your web application."
extra:
  srcUrl: "https://github.com/tfsec/tfsec/blob/4e68e1c5b3bc66982e4b7e6c5cc1c1642c87f83d/internal/app/tfsec/checks/aws045.go"
guidelines: |-
    #### Description
    When we create a web application, we specify one or more CloudFront distributions to delivery the data, videos,
    applications and APIs to customers globally with low latency, high transfer speeds, all within a developer-friendly
    environment. CloudFront provides security capabilities, including field level encryption and HTTPS support,
    seamlessly integrated with AWS Shield, AWS Web Application Firewall and Route 53 to protect against multiple
    types of attacks including network and application layer DDoS attacks. AWS WAF starts to allow, block, or count web
    requests for those distributions based on the conditions that you identify in the web ACL. Enabling WAF on CloudFront
    helps to inspect the data.

    #### Rationale
    AWS WAF starts to allow, block, or count web requests for those distributions based on the conditions that you
    identify in the web ACL. Enabling WAF on CloudFront helps to inspect the data.

    #### Remediation
    Specify the `web_acl_id` unique identifier that specifies the AWS WAF web ACL, if any, to associate with this distribution.

    Terraform example:
    ```
    resource "aws_cloudfront_distribution" "example" {
        ordered_cache_behavior {
          lambda_function_association {
            event_type   = "viewer-request"
            lambda_arn   = aws_lambda_function.example.qualified_arn
            include_body = false
          }
          ...
          ...
        }
    +   web_acl_id       =  "aws_wafv2_web_acl.example.arn"
        ...
        ...
    }
    ```

    #### References
    * https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id
lwid: []
provider: AWS
remediation:
  -
    checkType: Terraform
    steps:
      -
        action: add
        resource:
          - resource
        resourceAttribute: web_acl_id
        resourceAttributeType: string
        resourceAttributeValue: "<Provide the arn of the ACL>"
        resourceType:
          - aws_cloudfront_distribution
ruleId: AWS045
severity: High
sid: tfsec-aws045
title: "CloudFront distribution does not have a WAF in front"
