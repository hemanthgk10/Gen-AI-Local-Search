---
category: IAM
checkTool: tfsec
checkType: Terraform
compliance: []
description: "IAM profiles should be configured with the specific, minimum set of permissions required."
extra:
  srcUrl: "https://github.com/tfsec/tfsec/blob/4e68e1c5b3bc66982e4b7e6c5cc1c1642c87f83d/internal/app/tfsec/checks/aws046.go"
guidelines: |-
    ##### Description
    Ensure IAM policies don't allow blanket administrative privileges. IAM policies should be created with both explicit and minimal privileges.

    ##### Rationale
    Using administrative privileges when not necessary creates the potential for abuse by an attacker, who may exploit the over-privileged policy to perform malicious actions.

    ##### Remediation
    Manual Steps:
    1. Navigate to [Identity and Access Management][iam-console]
    2. In the left navigation, select Policies.
    3. Select the Policy and edit the document to define only the explicit permissions necessary for the role.
    4. Repeat for each policy that allows for Allow and Action set to `*` and Resource set to `*`.

    Terraform example:
    ```
    data "aws_iam_policy_document" "example" {
      statement {
        sid = "1"

    -   actions = ["*"]

    +   actions = [
    +     "s3:ListAllMyBuckets",
    +     "s3:GetBucketLocation",
    +   ]

        resources = ["*"]
      }
    }

    resource "aws_iam_policy" "example" {
      name   = "example_policy"
      path   = "/"
      policy = data.aws_iam_policy_document.example.json
    }
    ```

    ##### References
    * https://docs.aws.amazon.com/IAM/latest/UserGuide/access_controlling.html
    * https://docs.aws.amazon.com/IAM/latest/UserGuide/getting-started_create-admin-group.html
    * https://learn.hashicorp.com/terraform/aws/iam-policy

    [iam-console]: https://console.aws.amazon.com/iam/
lwid: []
provider: AWS
ruleId: AWS046
severity: High
sid: tfsec-aws046
title: "AWS IAM policy document has wildcard action statement"
