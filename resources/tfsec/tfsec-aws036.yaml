---
autofix: true
category: Encryption
checkTool: tfsec
checkType: Terraform
compliance: []
description: "Traffic flowing between Elasticache replication nodes should be encrypted to ensure sensitive data is kept private."
extra:
  srcUrl: "https://github.com/tfsec/tfsec/blob/4e68e1c5b3bc66982e4b7e6c5cc1c1642c87f83d/internal/app/tfsec/checks/aws036.go"
guidelines: |-
    #### Description
    Ensure all data stored in the Elasticache Replication Group is securely encrypted including the data in transit. By providing in-transit encryption capability, ElastiCache gives you a tool you can use to help protect your data when it is moving from one location to another.

    #### Rationale
    Traffic flowing between Elasticache replication nodes should be encrypted to ensure sensitive data is kept private and guard against unauthorized access of your data on the server.

    #### Remediation
    Enable the attribute `transit_encryption_enabled` to true.

    Terraform example:
    ```
    resource "aws_elasticache_replication_group" "baz" {
      replication_group_id          = "tf-redis-cluster"
      replication_group_description = "test description"
      node_type                     = "cache.t2.small"
      port                          = 6379
      automatic_failover_enabled    = true

    - transit_encryption_enabled    = false
    + transit_encryption_enabled    = true
      ...
      ...
    }
    ```

    #### References
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled
    * https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html
lwid: []
provider: AWS
remediation:
  -
    checkType: Terraform
    steps:
      -
        action: modify
        resource:
          - resource
        resourceAttribute: transit_encryption_enabled
        resourceAttributeType: boolean
        resourceAttributeValue: "true"
        resourceType:
          - aws_elasticache_replication_group
ruleId: AWS036
severity: Medium
sid: tfsec-aws036
title: "Elasticache Replication Group uses unencrypted traffic"
