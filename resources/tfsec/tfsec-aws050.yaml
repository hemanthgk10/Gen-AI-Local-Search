---
autofix: true
category: Network
checkTool: tfsec
checkType: Terraform
compliance: []
description: "Opening up ACLs to the public internet is potentially dangerous. You should restrict access to IP addresses or ranges that explicitly require it where possible, and ensure that you specify required ports."
extra:
  srcUrl: "https://github.com/tfsec/tfsec/blob/master/internal/app/tfsec/checks/aws050.go"
guidelines: |-
    #### Description
    The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. It is recommended that no NACL allows unrestricted ingress access to `all` ports and `protocols`.

    #### Rationale
    Public access to `all` protocols and ports includes remote server administration ports, such as `22` and `3389`, increases resource attack surface and unnecessarily raises the risk of resource compromise.

    #### Remediation
    Set the `protocol` to specific protocol rather than `all` and also `from_port` and `to_port` to a specific port.

    Terraform example:
    ```
    resource "aws_network_acl_rule" "example" {
        egress         = false
    -   protocol       = "all"
    +   protocol       = "tcp"
    +   from_port      = 22
    +   to_port        = 22
        rule_action    = "allow"
        cidr_block     = "10.0.0.0/16"
        ...
        ...
    }
    ```

    From *AWS Console*:
    1. Login to the [AWS Management Console](https://console.aws.amazon.com/vpc/home)
    2. In the left pane, click `Network ACLs`
    3. For each network ACL to remediate, perform the following:
       a. Select the network ACL
       b. Click the `Inbound Rules` tab
       c. Click Edit `Inbound rules`
       d. Either update the `Source` field to a range other than `0.0.0.0/0`, and select a specific protocol and port.
       e. Click `Save`

    #### References
    * https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block
    * https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html#VPC_Security_Comparison
lwid: []
provider: AWS
remediation:
  -
    checkType: Terraform
    steps:
      -
        action: modify
        resource:
          - resource
        resourceAttribute: protocol
        resourceAttributeType: string
        resourceAttributeValue: tcp
        resourceType:
          - aws_network_acl_rule
      -
        action: add
        resource:
          - resource
        resourceAttribute: from_port
        resourceAttributeType: integer
        resourceAttributeValue: "22"
        resourceType:
          - aws_network_acl_rule
      -
        action: add
        resource:
          - resource
        resourceAttribute: to_port
        resourceAttributeType: integer
        resourceAttributeValue: "22"
        resourceType:
          - aws_network_acl_rule
ruleId: AWS050
severity: Critical
sid: tfsec-aws050
title: "An ingress Network ACL rule allows ALL ports from /0"
