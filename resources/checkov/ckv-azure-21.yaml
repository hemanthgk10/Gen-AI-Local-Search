category: General
checkTool: checkov
checkType: Terraform
compliance:
- CIS
description: Security Center emails the subscription owners whenever a high-severity
  alert is triggered for their subscription. You should provide a security contact
  email address as an additional email address.
extra:
  entity: Microsoft.Security/securityContacts
  type: resource
guidelines: |-
  #### Description
  Security Center emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.

  #### Rationale
  Azure Security Center emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.

  #### Remediation
  Terraform example
  ```
  resource "azurerm_security_center_contact" "example" {
  +   email = "contact@example.com"
      phone = "+1-555-555-5555"

      alert_notifications = true
      alerts_to_admins    = true
  }
  ```

  From *Azure Console*

    1. Go to `Security Center`
    2. Click on `Pricing & settings`
    3. Click on the appropriate Management Group, Subscription, or Workspace
    4. Click on `Email notifications`
    5. Enter a valid security contact email address (or multiple addresses separated by commas) in the `Additional email addresses` field
    6. Click `Save`

  By default, there are no additional email addresses entered.

  #### References
  * https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details
  * https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/list
  * https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/update
  * https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-governance-strategy#gs-3-define-security-posture-management-strategy

  #### Additional Information:
  Excluding any of the entries in recommendations block in input.json disables the specific setting by default.
lwid:
  - AWS_CIS_1_20
provider: Azure
ruleId: CKV_AZURE_21
severity: High
sid: ckv-azure-21
title: Ensure that 'Send email notification for high severity alerts' is set to 'On'
