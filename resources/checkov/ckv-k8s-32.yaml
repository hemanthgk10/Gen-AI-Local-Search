category: Security
checkTool: checkov
checkType: Kubernetes
compliance:
- CIS
description: Seccomp (secure computing mode) is used to restrict the set of system
  calls applications can make, allowing cluster administrators greater control over
  the security of workloads running in the cluster. Enable docker/default seccomp
  profile in your pod definitions.
extra:
  entity: PodSecurityPolicy
  type: PodSecurityPolicy
guidelines: |-
  #### Description
  Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Enable docker/default seccomp profile in your pod definitions.

  #### Rationale
  Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.

  #### Remediation
  Review the pod definitions in your cluster. It should create a line as below:

  ```yaml
   annotations:
      seccomp.security.alpha.kubernetes.io/pod: docker/default
  ```

  *Seccomp* is an alpha feature currently. By default, all alpha features are disabled. So, you would need to enable alpha features in the apiserver by passing `--feature- gates=AllAlpha=true` argument.
  Edit the ``/etc/kubernetes/apiserver` file on the master node and set the KUBE_API_ARGS parameter to `--feature-gates=AllAlpha=true`

  ```yaml
  KUBE_API_ARGS="--feature-gates=AllAlpha=true"
  ```

  Based on your system, restart the kube-apiserver service. For example:
  ```
  systemctl restart kube-apiserver.service
  ```

  #### References
  * https://docs.docker.com/engine/security/seccomp/
  * https://github.com/kubernetes/kubernetes/issues/39845
  * https://github.com/kubernetes/kubernetes/pull/21790
  * https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples
provider: Kubernetes
ruleId: CKV_K8S_32
severity: Low
sid: ckv-k8s-32
title: Ensure default seccomp profile set to docker/default or runtime/default
