category: Security
checkTool: checkov
checkType: Terraform
compliance:
- CIS
description: Ensure Kubernetes Dashboard is disabled
extra:
  entity: Microsoft.ContainerService/managedClusters
  type: resource
guidelines: |-
  #### Description
  Dashboard is a web-based Kubernetes user interface. You can use Dashboard to deploy containerized applications to a Kubernetes cluster, troubleshoot your containerized application, and manage the cluster resources. You can use Dashboard to get an overview of applications running on your cluster, as well as for creating or modifying individual Kubernetes resources (such as Deployments, Jobs, DaemonSets, etc).

  #### Rationale
  Kubernetes Dashboard had elevated privileges on the cluster. When the care is not taken care to secure the dashboard, it can result in hack similar to what happened for Tesla.

  #### Remediation
  * Make sure you have RBAC enabled in the cluster.
  * Make sure not to grant the dashboard service account elevated privileges.
      OR
    Use a ServiceAccount token instead of just giving access to the dashboard ServiceAccount.

  Remove the `addon_profile.kube_dashboard` to disable the kubernetes dashboard.

  Terraform example of AKS cluster
  ```
  resource "azurerm_kubernetes_cluster" "example" {
      name                = "example-aks1"
      location            = azurerm_resource_group.example.location
      resource_group_name = azurerm_resource_group.example.name
      dns_prefix          = "exampleaks1"
      addon_profile {
  -      kube_dashboard  {
  -        enabled   = false
  -      }
         ...
         ...
      }
      ...
      ...
  }
  ```

  #### References
  * https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/
  * https://blog.heptio.com/on-securing-the-kubernetes-dashboard-16b09b1b7aca
lwid: []
provider: Azure
ruleId: CKV_AZURE_8
severity: Low
sid: ckv-azure-8
title: Ensure Kubernetes Dashboard is disabled
