---
category: Monitoring
checkTool: checkov
checkType: Terraform
compliance: []
description: |-
    Amazon Elastic Compute Cloud (Amazon EC2) provides scalable computing capacity in the Amazon Web Services (AWS) Cloud. You can use Amazon EC2 to launch as many or as few virtual servers as you need, configure security and networking, and manage storage. Amazon EC2 enables you to scale up or down to handle changes in requirements or spikes in popularity, reducing your need to forecast traffic.
    You can monitor the status of your instances by viewing status checks and scheduled events for your instances.
    A status check gives you the information that results from automated checks performed by Amazon EC2. These automated checks detect whether specific issues are affecting your instances. The status check information, together with the data provided by Amazon CloudWatch, gives you detailed operational visibility into each of your instances.
    You can also see status of specific events that are scheduled for your instances. The status of events provides information about upcoming activities that are planned for your instances, such as rebooting or retirement. They also provide the scheduled start and end time of each event.
extra:
  entity: aws_instance
  type: resource
guidelines: |-
    #### Description
    Amazon Elastic Compute Cloud (Amazon EC2) provides scalable computing capacity in the Amazon Web Services (AWS) Cloud. You can use Amazon EC2 to launch as many or as few virtual servers as you need, configure security and networking, and manage storage. Amazon EC2 enables you to scale up or down to handle changes in requirements or spikes in popularity, reducing your need to forecast traffic.

    You can monitor the status of your instances by viewing status checks and scheduled events for your instances.

    A status check gives you the information that results from automated checks performed by Amazon EC2. These automated checks detect whether specific issues are affecting your instances. The status check information, together with the data provided by Amazon CloudWatch, gives you detailed operational visibility into each of your instances.

    You can also see status of specific events that are scheduled for your instances. The status of events provides information about upcoming activities that are planned for your instances, such as rebooting or retirement. They also provide the scheduled start and end time of each event.

    #### Rationale
    Having monitoring turned on for your AWS instance gives you a detailed information when there is an outage or issue with instance itself which can help for debugging and auditing purposes.

    #### Remediation
    Set the `monitoring` flag of `aws_instance` to `true`.

    Terraform example
    ```
    resource "aws_instance" "foo" {
        ami           = "ami-005e54dee72cc1d00" # us-west-2
        instance_type = "t2.micro"

        network_interface {
          network_interface_id = aws_network_interface.foo.id
          device_index         = 0
        }

        credit_specification {
          cpu_credits = "unlimited"
        }

    +   monitoring = true
        ...
        ...
    }
    ```

    CloudFormation example:
    ```json
    {
        "Type" : "AWS::EC2::Instance",
        "Properties" : {
            "AvailabilityZone" : "us-east-2a",
            "DisableApiTermination" : true,
    +       "Monitoring": true,
            ...
            ...
    }
    ```

    #### References
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring
    * https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html
lwid: []
provider: AWS
ruleId: CKV_AWS_126
severity: Low
sid: ckv-aws-126
title: "Ensure that detailed monitoring is enabled for EC2 instances"
autofix: true
remediation:
- checkType: Terraform
  steps:
  - action: add
    resource: [ "resource" ]
    resourceAttribute: monitoring
    resourceAttributeType: boolean
    resourceAttributeValue: "true"
    resourceType: [ "aws_instance" ]
