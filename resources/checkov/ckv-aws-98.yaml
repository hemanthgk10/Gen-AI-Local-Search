---
category: Storage
checkTool: checkov
checkType: Terraform
compliance: []
description: "Amazon SageMaker is a fully managed machine learning service. With SageMaker, data scientists and developers can quickly and easily build and train machine learning models, and then directly deploy them into a production-ready hosted environment. It provides an integrated Jupyter authoring notebook instance for easy access to your data sources for exploration and analysis, so you don't have to manage servers. To protect your Amazon SageMaker Studio notebooks and SageMaker notebook instances, along with your model-building data and model artifacts, SageMaker uses the AWS Key Management Service (AWS KMS) to encrypt the notebooks and data."
extra:
  entity: aws_sagemaker_endpoint_configuration
  type: resource
guidelines: |-
    #### Description
    Amazon SageMaker is a fully managed machine learning service. With SageMaker, data scientists and developers can quickly and easily build and train machine learning models, and then directly deploy them into a production-ready hosted environment. It provides an integrated Jupyter authoring notebook instance for easy access to your data sources for exploration and analysis, so you don't have to manage servers. To protect your Amazon SageMaker Studio notebooks and SageMaker notebook instances, along with your model-building data and model artifacts, SageMaker uses the AWS Key Management Service (AWS KMS) to encrypt the notebooks and data.

    #### Rationale
    Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.

    #### Remediation
    Specifing the `kms_key_arn` for Amazon SageMaker service, should encrypt data on the storage volume attached to the ML compute instance.


    Terraform example
    ```
    resource "aws_sagemaker_endpoint_configuration" "ec" {
        name = "my-endpoint-config"

        production_variants {
          variant_name           = "variant-1"
          model_name             = aws_sagemaker_model.m.name
          initial_instance_count = 1
          instance_type          = "ml.t2.medium"
        }

        tags = {
          Name = "foo"
        }

    +   kms_key_arn = aws_kms_key.example.arn
        ...
        ...
    }
    ```

    CloudFormation example
    ```json
    {
      "Type" : "AWS::SageMaker::EndpointConfig",
      "Properties" : {
    +     "KmsKeyId" : "arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab",
          "EnableCapture" : true,
          ...
          ...
        }
    }
    ```

    #### References
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_endpoint_configuration#kms_key_arn
    * https://docs.aws.amazon.com/sagemaker/latest/dg/data-protection.html
lwid: []
provider: AWS
ruleId: CKV_AWS_98
severity: Medium
sid: ckv-aws-98
title: "Ensure all data stored in the Sagemaker Endpoint is securely encrypted at rest"
