---
category: Logging
checkTool: checkov
checkType: Terraform
compliance: []
description: |-
    Amazon Relational Database Service (Amazon RDS) is a web service that makes it easier to set up, operate, and scale a relational database in the AWS Cloud.

    RDS provides metrics in real time for the operating system (OS) that your DB instance runs on and it also supports the viewing of database logs. Logs can provide information on performance, access, usage and other important information.
extra:
  entity: aws_db_parameter_group
  type: resource
guidelines: |-
    #### Description
    Amazon Relational Database Service (Amazon RDS) is a web service that makes it easier to set up, operate, and scale a relational database in the AWS Cloud.

    RDS provides metrics in real time for the operating system (OS) that your DB instance runs on and it also supports the viewing of database logs. Logs can provide information on performance, access, usage and other important information.

    #### Rationale
    You can monitor the RDS error logs, the slow query logs when you enable query logging.

    #### Remediation
    To enable query logging on RDS, change the values of the following parameters by modifying a customized parameter group that is associated with the DB instance:

    * log_statement
    * log_min_duration_statement


    Terraform example
    ```
    resource "aws_db_instance" "default" {
        allocated_storage    = 10
        engine               = "mysql"
        engine_version       = "5.7"
        instance_class       = "db.t3.micro"
        name                 = "mydb"
        ...
        ...
    }

    resource "aws_db_parameter_group" "default" {
        name        = "rds-cluster-pg"
        family      = "mysql5.7"

    +   parameter {
    +      name  = "log_statement"
    +      value = "ddl"
    +   }

    +   parameter {
    +      name  = "log_min_duration_statement"
    +      value = "1000"
    +   }
        ...
        ...
    }
    ```

    #### References
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance
    * https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_parameter_group
    * https://aws.amazon.com/premiumsupport/knowledge-center/rds-postgresql-query-logging/
lwid: []
provider: AWS
ruleId: CKV2_AWS_30
severity: Low
sid: ckv2-aws-30
title: "Ensure Postgres RDS as aws_db_instance has Query Logging enabled"
